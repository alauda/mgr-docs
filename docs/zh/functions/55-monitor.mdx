---
weight: 55
---
# 监控告警

## 核心指标
```
SELECT 
  MEMBER_HOST,
  MEMBER_STATE,
  COUNT_TRANSACTIONS_REMOTE_IN_APPLIER_QUEUE AS apply_queue,
  COUNT_TRANSACTIONS_CHECKED AS checked_txns
FROM performance_schema.replication_group_member_stats;
```

## 集成功能
- Prometheus指标暴露
- Grafana预置看板
- 告警规则：
  ```yaml
  - alert: GroupReplicationDegraded
    expr: mysql_gr_member_status != 1
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "MySQL Group Replication degraded"
  ```

## 操作步骤
<Tabs>
<Tab label="CLI">
1. 访问Prometheus
```bash
kubectl port-forward -n monitoring svc/prometheus 9090
```

2. 查询集群状态
```
mysql_gr_member_available{cluster="$name"}
```
</Tab>

<Tab label="Web Console">
1. 进入 **监控** 页签
2. 查看预置面板：
   - 集群状态总览
   - 复制延迟分析
   - 资源使用率
3. 自定义查询：
   ```
   rate(mysql_global_status_commands_total{command="query"}[5m])
   ```
4. 设置告警阈值：
   - 节点离线
   - 复制延迟 > 30s
   - 磁盘使用率 > 80%
</Tab>
</Tabs>
