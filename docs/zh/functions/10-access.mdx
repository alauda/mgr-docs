---
weight: 10
---
# 访问方式

## 功能简介
提供多种访问 MySQL-MGR 集群的方式，支持集群内外访问和读写分离配置。

## 核心组件
- **MySQL Router**：提供读写分离和负载均衡

## 操作步骤

### ClusterIP

<Tabs>
    <Tab label="CLI">
        1. 获取 Service 名称: 根据实例名称, 对应的 Service 名称为 `${name}-read-write` 和 `${name}-read-only`
        2. 使用 MySQL Client 连接
        以访问读写服务为例：
        ```bash
        mysql -h${name}-read-write.${namespace} -P3306 -u${username} -p${password}
        ```
        3. 验证读写分离：
        ```bash
        SHOW VARIABLES LIKE 'read_only';
        ```
    </Tab>

    <Tab label="Web Console">
        1. 在实例详情页进入 **访问管理**
        2. 选择访问方式：
        - 集群内访问：读写或只读内部路由: 格式为`${实例名称}-read-write` 和 `${实例名称}-read-only`
        3. 获取账号密码
        4. 使用集群外或终端控制台 MySQL 客户端工具连接, 以访问读写服务为例：
        ```bash
        mysql -h${name}-read-write.${namespace} -P3306 -u${username} -p${password}
        ```
        5. 验证读写分离：
        ```bash
        SHOW VARIABLES LIKE 'read_only';
        ```
    </Tab>
</Tabs>


### NodePort
<Tabs>
    <Tab label="CLI">
        ::: tip 确认部署的访问模式
        确认字段被配置为 **NodePort**
        ```bash
        kubectl -n ${namespace} get mysql ${name} -o jsonpath='{.spec.mgr.router.svcRW.type}'
        ```
        :::
        1. 获取 NodePort 访问端口
        ```bash
        kubectl get svc -n ${namespace} ${name}-read-write -o jsonpath='{.spec.ports[0].nodePort}'
        ```
        2. 使用 MySQL Client 连接
        ```bash
        mysql -h${node_ip} -P${port} -u${username} -p${password}
        ```
        3. 验证读写分离：
        ```bash
        SHOW VARIABLES LIKE 'read_only';
        ```
    </Tab>

    <Tab label="Web Console">
        ::: tip 确认部署的访问模式
        在实例详情页进入 **访问管理**，存在 **集群外访问 - 通过 NodePort**。
        :::
        1. 在实例详情页进入 **访问管理**
        2. 选择访问方式：
        - 集群外访问 - 通过 NodePort：读写或只读 Router 连接地址
        3. 获取账号密码
        4. 使用集群外或终端控制台 MySQL 客户端工具连接
        ```bash
        mysql -h${node_ip} -P${port} -u${username} -p${password}
        ```
        5. 验证读写分离：
        ```bash
        SHOW VARIABLES LIKE 'read_only';
        ```
    </Tab>
</Tabs>
